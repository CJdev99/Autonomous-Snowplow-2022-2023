<?xml version="1.0"?>
<launch>
  <node pkg="tf" type="static_transform_publisher" name="imu_broadcaster" args="-.4064 .3048 .4572 0 0 0 base_link imu 30"/>
  <node pkg="tf" type="static_transform_publisher" name="base_link_broadcaster" args="0 0 0.889 0 0 0 base_footprint base_link 30" />
  <node pkg="tf" type="static_transform_publisher" name="map_to_odom" args="0 0 0 0 0 0 map odom 30" />
  <!--Launch odom, imu, gps-->


  <!-- subscribes to cmd_vel topic -->
  <!-- publishes odom topic with base_link frame -->
  <!-- broadcasts odom->base_footprint transform -->
  <include file="$(find roboteq_diff_driver)/launch/driver.launch"/>


  <node name="openzen_sensor" pkg="openzen_sensor" type="openzen_sensor_node">
    <remap from="imu/mag" to="openzen/mag"/>
    <remap from="imu/data" to="openzen/data"/>
    <param name="_baudrate" value="921600"/>
  </node>


  <!-- GPS launches: publishes NavSatFix to /fix, which will be used with navsat_transform_node-->
  <!-- /gps/fix-->
  <node pkg="nmea_socket_pub" type="driver.py" name="trimble_gps">
  </node>

 
  <rosparam command="load" file="$(find navstack_pub)/param/ekf_params.yaml" />
  <rosparam command="load" file="$(find navstack_pub)/param/navsat_params.yaml" />
  
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se_odom" clear_params="true"/>

  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se_map" clear_params="true">
    <remap from="odometry/filtered" to="odometry/filtered_map"/>
  </node>

  <node pkg="robot_localization" type="navsat_transform_node" name="navsat_transform" clear_params="true" output="screen">
    <remap from="odometry/filtered" to="odometry/filtered_map"/>
    <remap from="gps/fix" to="/trimble_gps/fix"/>
    <remap from="imu/data" to="/openzen/data"/>
  </node> 

</launch>